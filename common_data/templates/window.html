{% extends "base.html" %}
{% block head %}
    {% block head_extended %}{% endblock %}
{% endblock %}
{% block window %}

<nav class="navbar navbar-expand-sm bg-light" id="navbar" >
        <ul class="navbar-nav">
            <!--{% url 'base:workflow' %}-->
            <a class="navbar-brand" href="/base/workflow"  >SBS</a>
            {% if request.user %}
                
                <li>
                    <a href="{% url 'planner:dashboard' %}" class="nav-link">Planner<span class="badge badge-primary">
                        {% if request.user.employee %}
                        {{request.user.employee.agenda_items}}
                        {% else %}
                        0 {% endif %}
                    </span><sub><span class="badge badge-danger" >beta!</span></sub></a>
                </li>
                <li>
                    <a href="{% url 'messaging:inbox' %}" class="nav-link">Inbox <span class="badge badge-primary" id='id_message_count'>{{request.user.inbox.total_in}}</span><sub><span class="badge badge-danger" >beta!</span></sub></a>
                    <script>
                        // need to find a better way that does not violate the session check
                        function inboxCounter(){
                            $.get('/messaging/inbox-counter').then(function(res){
                                $('#id_message_count').text(res.count);
                            });
                        }

                        $(document).ready(function(){
                            setInterval(inboxCounter, 3000000)
                        })
                    </script>
                </li>
            {% endif %}
            {% if request.user.is_superuser or request.user.employee.is_sales_rep %}
            <li class="nav-item active"><a class="nav-link" href="{% url 'invoicing:home' %}">Sales</a></li>
            {% endif %}
            {% if request.user.is_superuser or request.user.employee.is_inventory_controller %}
            <li class="nav-item"><a class="nav-link" href="{% url 'inventory:home' %}">Inventory</a></li>
            {% endif %}
            {% if request.user.is_superuser or request.user.employee.is_sales_rep %}
            <li><a class="nav-link" href="{% url 'accounting:dashboard' %}">Accounting</a></li>
            {% endif %}
            {% if request.user.is_superuser or request.user.employee.is_serviceperson %}
            <li>
                <a href="{% url 'services:dashboard' %}" class="nav-link">Services</a>
            </li>
            {% endif %}
            {% if request.user.is_superuser or request.user.employee.is_payroll_officer %}
            <li>
                <a class="nav-link" href="{% url 'employees:dashboard' %}">Employees</a>
            </li>
            {% endif %}
            <!--
            {% if request.user.is_superuser or request.user.employee.is_manufacturing_associate %}
            <li>
                <a class="nav-link" href="{% url 'manufacturing:dashboard' %}">Manufacturing</a>
            </li>
            {% endif %}
            -->
        </ul>
</nav>
<article>
    <div>
        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-info">
                    {{message}}
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                </div>
            {% endfor %}
        
        {% endif %}
    </div>
    <!--
    <button id="id-trigger-button">
        Trigger Modal
    </button>
    -->
    {% block content %}{% endblock %}
</article>
<hr class="my-2" />
<footer class="bg-primary" id="footer">
    <div style="padding:1cm;">
        <div class="text-white" style="padding:1cm;display:inline-block;">
        <h5>Users</h5>
        <ul style="list-style-type:none">
            <li style="color:white;">{{request.user.username}} is logged in.</li>
            <li ><a style="color:white;" href="/logout?next=/login/">Logout</a></li>    
        </ul>
    </div>
    <div class="text-white" style="padding:1cm;display:inline-block;border-left:3px solid white;">
        <h5>Quick Actions</h5>
        <ul style="list-style-type:none">
            {% if request.user.is_superuser %}
            <li><a style="color:white;" href="{% url 'base:config' pk=1 %}">Global Settings</a></li>
            {% endif %}
            <li>
                <a style="color:white;" href="{% url 'employees:time-logger' %}">Run Time logger</a>
            </li>
        </ul>
    </div>
    <div class="text-white" style="padding:1cm;display:inline-block;border-left:3px solid white;">
        <h5>About</h5>
        <ul style="list-style-type:none;">
        <li><a style="color:white;" href="/base/about/">About</a></li>
        <li><a style="color:white;" href="#">Software License</a></li>

    </ul>
    </div>
    </div>
    
</footer>
<script type="text/javascript">
    $(".ui-date-picker").datepicker();
</script>
{% endblock %}