{% extends "window.html" %}

{% block content %}

<style>
.roomy {
    padding: 5px;
}
</style>

<div class="jumbotron">
    <h1 class="display-3">Work Order Costing</h1>
    <p class="lead">This page lists and totals all the costs incurred in executing a work order</p>
    <hr class="my-2">
    <p>Actions</p>
    <p class="lead">
        <a class="btn btn-primary" href="{% url 'services:work-order-expense-create' pk=object.pk %}"
            role="button">Record Expense</a>
    </p>
</div>

<div class="container">
    <div class="row">
        <div class="col-6">
            <h4 class="text-white roomy bg-primary">Direct Labour expenses</h4>
            <p><b>NB</b> Direct labour costs are only recorded for employees on wages whose payment depends on the
                number of hours worked.</p>
            <table class="table table-sm">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Employee</th>
                        <th>Normal Time</th>
                        <th>Overtime</th>
                        <th>Labour($)</th>
                    </tr>
                </thead>
                <tbody>
                    {% for log in object.time_logs %}
                    <tr>
                        <td>{{log.date}}</td>
                        <td>{{log.employee}}</td>
                        <td>{{log.normal_time}}</td>
                        <td>{{log.overtime}}</td>
                        <td>{{log.total_cost}}</td>
                    </tr>
                    {% endfor %}
                </tbody>
                <tfoot>
                    <tr>
                        <th colspan="4">Total</th>
                        <td>{{total_labour_cost}}</td>
                    </tr>
                </tfoot>
            </table>
        </div>
        <div class="col-6">
            <h4 class="bg-primary text-white roomy">Cost of revenue expenses</h4>
            <table class="table table-sm">
                <thead>
                    <tr>
                        <th>Expense ID</th>
                        <th>Date</th>
                        <th>Category</th>
                        <th>Amount</th>
                    </tr>
                </thead>
                <tbody>
                    {% for expense in object.workorderexpense_set.all %}
                    <tr>
                        <td>{{expense.expense.id}}</td>
                        <td>{{expense.expense.date}}</td>
                        <td>{{expense.expense.category}}</td>
                        <td>{{expense.expense.amount}}</td>
                    </tr>
                    {% endfor %}
                </tbody>
                <tfoot>
                    <tr>
                        <th colspan="2">Total</th>
                        <td>{{total_expense_costs}}</td>
                    </tr>
                </tfoot>
            </table>

        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <h4 class="text-white roomy bg-primary">Total Expenses: <span style="float:right;">${{total_costs}}</span></h4>
        </div>
    </div>
</div>



{% endblock content %}